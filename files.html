<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#1e90ff" />
  <title>–§–∞–π–ª—ã ‚Äî Z1LIKE</title>

  <!-- favicons -->
  <link rel="icon" type="image/png" href="photo/logo.png?v=3" sizes="any" />
  <link rel="icon" type="image/png" href="photo/logo-32.png?v=3" sizes="32x32" />
  <link rel="icon" type="image/png" href="photo/logo-16.png?v=3" sizes="16x16" />
  <link rel="apple-touch-icon" href="photo/logo-180.png?v=3" />
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico?v=3" />

  <style>
    :root{--brand:#1e90ff;--ink:#e5e7eb;--muted:#9ca3af;--bg:#0f172a;--card:#1e293b;--line:#334155}
    html,body{height:100%}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,sans-serif;background:var(--bg);margin:0;color:var(--ink)}

    header{display:flex;align-items:center;justify-content:center;gap:10px;position:sticky;top:0;z-index:1100;
      background:linear-gradient(0deg,var(--brand),#2563eb);color:#fff;padding:14px 10px;font-weight:800;box-shadow:0 2px 10px rgba(0,0,0,.4)}
    header img.logo{height:40px;border-radius:6px}
    #menuBtn{position:absolute;left:12px;top:50%;transform:translateY(-50%);background:#1e293b;color:#fff;border:none;border-radius:10px;padding:8px 10px;cursor:pointer;z-index:1200}

    .menu{position:fixed;top:0;left:0;width:260px;height:100%;background:#0b1220;box-shadow:2px 0 10px rgba(0,0,0,.4);
      padding:20px;transform:translateX(-100%);transition:transform .3s ease;z-index:1150}
    .menu.open{transform:translateX(0)}
    .menu a{display:block;color:#e5e7eb;padding:12px 0;text-decoration:none;border-bottom:1px solid #1e293b}
    .menu a[aria-current="page"]{font-weight:700}
    .backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);opacity:0;pointer-events:none;transition:opacity .2s ease;z-index:1140}
    .backdrop.show{opacity:1;pointer-events:auto}

    .container{max-width:1100px;margin:20px auto;padding:20px;background:var(--card);border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,.5)}
    .top{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:10px}
    .crumbs{color:#cbd5e1;font-size:14px}
    .search{flex:1;min-width:220px}
    .search input{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--line);background:#0b1220;color:#cbd5e1}

    .files{margin-top:10px;border:1px solid var(--line);border-radius:12px;overflow:hidden}
    .row{display:grid;grid-template-columns:28px 1fr 120px 160px 140px;gap:10px;align-items:center;padding:12px;border-top:1px solid var(--line);background:rgba(2,6,23,.10)}
    .row.head{border-top:none;background:rgba(2,6,23,.20);font-size:12px;color:#94a3b8;text-transform:uppercase;letter-spacing:.05em}
    .row.item:hover{background:rgba(2,6,23,.18)}
    .name{display:flex;align-items:center;gap:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .name a{color:inherit;text-decoration:none}
    .tag{font-size:12px;border:1px solid var(--line);padding:2px 6px;border-radius:999px;margin-left:6px;color:#cbd5e1}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;gap:6px;padding:8px 10px;border-radius:10px;border:1px solid var(--line);background:#0b1220;color:#cbd5e1;text-decoration:none}
    @media(max-width:900px){.row{grid-template-columns:28px 1fr 110px 150px 130px}}
    @media(max-width:760px){.row{grid-template-columns:28px 1fr 110px 150px}.actions{grid-column:1/-1}}
    @media(max-width:560px){.row{grid-template-columns:28px 1fr 110px}.col-date{display:none}.actions{grid-column:1/-1}}

    footer{text-align:center;color:var(--muted);margin:20px;font-size:13px}
  </style>
</head>
<body>
  <header>
    <button id="menuBtn">‚ò∞</button>
    <img src="photo/logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo" />
    <span>–§–∞–π–ª—ã</span>
  </header>

  <nav class="menu" id="menu">
    <a href="index.html">üè† –ì–ª–∞–≤–Ω–∞—è</a>
    <a href="prepods.html">üë©‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</a>
    <a href="files.html" aria-current="page">üìÅ –§–∞–π–ª—ã</a>
    <a href="copy.html">üóìÔ∏è –ö–æ–¥ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</a>
  </nav>
  <div class="backdrop" id="backdrop"></div>

  <main class="container">
    <div class="top">
      <h2 style="margin:0">–ö–∞—Ç–∞–ª–æ–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h2>
      <div class="crumbs" id="crumbs">/</div>
      <div class="search"><input id="search" type="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏‚Ä¶" /></div>
    </div>

    <div class="files">
      <div class="row head"><div></div><div>–ò–º—è</div><div>–†–∞–∑–º–µ—Ä</div><div class="col-date">–ò–∑–º–µ–Ω—ë–Ω</div><div>–î–µ–π—Å—Ç–≤–∏–µ</div></div>
      <div id="rows"></div>
    </div>
  </main>

  <footer>Made by Z1LIKE</footer>

  <script>
    // ==== –ö–æ–Ω—Ñ–∏–≥ ====
    const CONFIG = { owner:"Z1LIKE", repo:"02nb", branch:"main", rootPath:"Files" };

    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    const fmtBytes = n => n==null?"‚Äî":(n<1024?`${n} B`:n<1048576?`${(n/1024).toFixed(1)} KB`:`${(n/1048576).toFixed(1)} MB`);
    const fmtDate = iso => iso ? new Date(iso).toLocaleString() : "‚Äî";
    const icon = (t,n)=> t==="dir" ? "üìÇ" : /\.(pdf|docx?|xlsx?|pptx?)$/i.test(n) ? "üìÑ" : /\.(png|jpe?g|gif|webp|svg)$/i.test(n) ? "üñºÔ∏è" : "üìÑ";

    async function api(path, params={}) {
      const url = new URL(`https://api.github.com${path}`);
      Object.entries(params).forEach(([k,v])=> url.searchParams.set(k,v));
      url.searchParams.set("ts", Date.now());
      const res = await fetch(url, {
        headers: { "Accept":"application/vnd.github+json", "Cache-Control":"no-cache" },
        cache: "no-store"
      });
      if (!res.ok) {
        let msg = `${res.status} ${res.statusText}`;
        try { const t = await res.json(); if (t?.message) msg += `: ${t.message}` } catch {}
        throw new Error(msg);
      }
      return res.json();
    }

    (function(){
      const menu=$("#menu"),btn=$("#menuBtn"),backdrop=$("#backdrop");
      const open=()=>{menu.classList.add("open");backdrop.classList.add("show");};
      const close=()=>{menu.classList.remove("open");backdrop.classList.remove("show");};
      btn.addEventListener("click",e=>{e.preventDefault();menu.classList.contains("open")?close():open();});
      backdrop.addEventListener("click",close);
      window.addEventListener("keydown",e=>{if(e.key==="Escape")close();});
    })();

    const pathFromHash = () => decodeURIComponent(location.hash.replace(/^#\/?/, ""));
    const setHash = p => location.hash = `/${encodeURIComponent(p)}`;
    function renderCrumbs(path){
      const segs = path.split("/").filter(Boolean);
      $("#crumbs").textContent = segs.length ? segs.map((s,i)=> i===0?`/${s}`:` / ${s}`).join("") : "/";
    }
    const encPath = p => p.split("/").filter(Boolean).map(encodeURIComponent).join("/");

    async function list(path=""){
      const repoPath = [CONFIG.rootPath, path].filter(Boolean).join("/");
      let items;
      try{
        items = await api(`/repos/${CONFIG.owner}/${CONFIG.repo}/contents/${encPath(repoPath)}`, { ref: CONFIG.branch });
      }catch(e){
        $("#rows").innerHTML = `<div class='row item'><div>‚ö†Ô∏è</div><div class='name'>${e.message}</div><div>‚Äî</div><div class="col-date">‚Äî</div><div>‚Äî</div></div>`;
        return;
      }

      renderCrumbs(path);
      items.sort((a,b)=> (a.type===b.type ? a.name.localeCompare(b.name) : a.type==="dir" ? -1 : 1));

      const commitMap = {};
      await Promise.all(items.map(async it=>{
        const full = [repoPath, it.name].filter(Boolean).join("/");
        try{
          const [c] = await api(`/repos/${CONFIG.owner}/${CONFIG.repo}/commits`, { path: full, sha: CONFIG.branch, per_page: 1 });
          commitMap[it.name] = c ? c.commit.author.date : null;
        }catch{ commitMap[it.name]=null; }
      }));

      $("#rows").innerHTML = items.map(it=>{
        const isDir = it.type==="dir";
        const href = isDir
          ? `href="#" data-open="${[path,it.name].filter(Boolean).join("/")}"`
          : `href="${it.download_url}?ts=${Date.now()}" target="_blank" rel="noopener"`;
        return `
          <div class="row item" data-name="${it.name.toLowerCase()}">
            <div>${icon(it.type,it.name)}</div>
            <div class="name"><a ${href}>${it.name}</a> ${isDir?'<span class="tag">–ø–∞–ø–∫–∞</span>':'<span class="tag">—Ñ–∞–π–ª</span>'}</div>
            <div>${isDir?'‚Äî':fmtBytes(it.size)}</div>
            <div class="col-date">${fmtDate(commitMap[it.name])}</div>
            <div class="actions">
              ${isDir?`<a class="btn" href="#" data-open="${[path,it.name].filter(Boolean).join("/")}">–û—Ç–∫—Ä—ã—Ç—å</a>`
                     :`<a class="btn" href="${it.download_url}?ts=${Date.now()}" target="_blank" rel="noopener">–°–∫–∞—á–∞—Ç—å</a>`}
            </div>
          </div>`;
      }).join("");

      $$("#rows [data-open]").forEach(a=> a.addEventListener("click", e=>{ e.preventDefault(); setHash(a.dataset.open); }));
    }

    $("#search").addEventListener("input", e=>{
      const q = e.target.value.trim().toLowerCase();
      $$("#rows .row.item").forEach(r=>{
        const name=(r.getAttribute("data-name")||"").toLowerCase();
        r.style.display = name.includes(q) ? "" : "none";
      });
    });

    window.addEventListener("hashchange", ()=> list(pathFromHash()));
    list(pathFromHash());
  </script>
</body>
</html>
