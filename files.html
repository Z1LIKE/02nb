<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–§–∞–π–ª—ã</title>
</head>
<body>

<script>
/*
  –ï–î–ò–ù–´–ô –°–ö–†–ò–ü–¢ (–∏–Ω–ª–∞–π–Ω). –ù–∏—á–µ–≥–æ –±–æ–ª—å—à–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.
  –ö–æ–Ω—Ñ–∏–≥ –Ω–∏–∂–µ —É–∂–µ –ø–æ–¥ —Ç–µ–±—è: Z1LIKE / 02nb / main / Files.
*/
(() => {
  // === –¢–í–û–ò –ù–ê–°–¢–†–û–ô–ö–ò ===
  const CFG = {
    owner: "Z1LIKE",
    repo: "02nb",
    branch: "main",
    rootPath: "Files",          // –∫–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
    showCommitDates: false,     // –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –∫–Ω–æ–ø–∫–æ–π ‚è±
    pages: { index: "index.html", teachers: "teachers.html", files: "files.html" },
    brand: { title: "–§–∞–π–ª—ã", logo: "photo/logo.png", footer: "Made by Z1LIKE" }
  };

  // === —Ö–µ–ª–ø–µ—Ä—ã ===
  const h = (t, a = {}, c = []) => {
    const el = document.createElement(t);
    Object.entries(a).forEach(([k, v]) => {
      if (k === "style" && typeof v === "object") Object.assign(el.style, v);
      else if (k.startsWith("on")) el.addEventListener(k.slice(2), v);
      else el.setAttribute(k, v);
    });
    (Array.isArray(c) ? c : [c]).forEach(n => typeof n === "string" ? el.insertAdjacentHTML("beforeend", n) : n && el.appendChild(n));
    return el;
  };

  // === CSS ===
  const css = `:root{--brand:#1e90ff;--ink:#e5e7eb;--muted:#9ca3af;--bg:#0f172a;--card:#1e293b;--radius:16px;--line:#334155}
  html,body{height:100%} body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica Neue,Arial,Noto Sans,sans-serif;background:var(--bg);margin:0;color:var(--ink);-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;font-size:clamp(14px,1.7vw,16px)}
  header{position:sticky;top:0;z-index:10;background:linear-gradient(0deg,var(--brand),#2563eb);color:#fff;padding:calc(env(safe-area-inset-top)+clamp(10px,2.2vw,18px)) clamp(10px,2.2vw,18px) clamp(10px,2.2vw,18px);text-align:center;box-shadow:0 2px 10px rgba(0,0,0,.4);display:flex;align-items:center;justify-content:center;gap:10px;-webkit-user-select:none;user-select:none}
  header img.logo{height:clamp(28px,6vw,48px);width:auto;border-radius:6px;-webkit-user-drag:none;user-drag:none}
  header h1{margin:0;font-weight:800;letter-spacing:.2px;font-size:clamp(18px,4.5vw,26px);display:inline-flex;align-items:center;gap:8px}
  .menu-btn{position:absolute;left:12px;top:50%;transform:translateY(-50%);appearance:none;border:none;background:rgba(2,6,23,.25);color:#fff;border:1px solid rgba(255,255,255,.2);padding:10px 12px;border-radius:10px;cursor:pointer;font-size:16px;line-height:1}
  .menu-btn:active{transform:translateY(-50%) scale(.98)}
  .drawer{position:fixed;inset:0 auto 0 0;width:min(88vw,320px);background:#0b1220;border-right:1px solid var(--line);transform:translateX(-100%);transition:transform .28s ease;z-index:1000;display:flex;flex-direction:column;padding:12px}
  .drawer.open{transform:translateX(0)} .drawer header{position:relative;background:transparent;box-shadow:none;padding:6px 6px 12px;justify-content:flex-start;gap:8px}
  .drawer-title{font-weight:800;color:#e5e7eb;margin-left:6px}
  .drawer a{display:flex;align-items:center;gap:10px;padding:12px;border-radius:10px;text-decoration:none;color:#e5e7eb;border:1px solid transparent}
  .drawer a:hover{background:#111827;border-color:#1f2937} .drawer .icon{width:18px;text-align:center}
  .backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:900;opacity:0;transition:opacity .2s ease}
  .backdrop.show{opacity:1}
  .toc{background:rgba(30,41,59,.95);box-shadow:0 2px 10px rgba(0,0,0,.3)}
  .toc-inner{max-width:1100px;margin:0 auto;padding:10px clamp(12px,2.8vw,24px);display:flex;gap:8px;overflow:auto;-webkit-overflow-scrolling:touch;scroll-snap-type:x mandatory}
  .chip{white-space:nowrap;display:inline-block;border:1px solid var(--line);padding:10px 14px;border-radius:999px;font-size:14px;color:#f1f5f9;background:#1e293b;text-decoration:none;transition:.2s;scroll-snap-align:start}
  .chip:hover{background:#334155}
  .container{max-width:1100px;margin:clamp(12px,3vw,30px) auto;background:var(--card);border-radius:var(--radius);padding:clamp(12px,3.2vw,30px);box-shadow:0 4px 20px rgba(0,0,0,.5)}
  .topbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:12px}
  .search{flex:1;min-width:220px} .search input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid var(--line);background:#0b1220;color:#cbd5e1}
  h2{color:#fff;font-size:clamp(18px,3.8vw,22px);margin:0} .crumbs{color:#cbd5e1;font-size:clamp(12px,2.8vw,14px)}
  .files{margin-top:14px;border:1px solid var(--line);border-radius:12px;overflow:hidden}
  .row{display:grid;grid-template-columns:28px 1fr 120px 140px 120px;gap:10px;align-items:center;padding:14px;border-top:1px solid var(--line);background:rgba(2,6,23,.12)}
  .row.head{border-top:none;background:rgba(2,6,23,.24);font-size:12px;color:#94a3b8;text-transform:uppercase;letter-spacing:.06em}
  .row.item{background:rgba(2,6,23,.08)} .row.item:hover{background:rgba(2,6,23,.18)}
  .name{display:flex;align-items:center;gap:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .name a{color:inherit;text-decoration:none;display:inline-block;padding:6px 0}
  .tag{font-size:12px;border:1px solid var(--line);padding:2px 6px;border-radius:999px;color:#cbd5e1}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .btn{display:inline-flex;align-items:center;gap:6px;padding:12px;border-radius:12px;border:1px solid var(--line);background:#0b1220;color:#cbd5e1;text-decoration:none;font-size:14px;touch-action:manipulation}
  .btn:hover{border-color:#64748b} .empty{display:flex;align-items:center;gap:8px;color:#94a3b8}
  @media (max-width:800px){.row{grid-template-columns:28px 1fr 110px 120px}.col-size{display:none}}
  @media (max-width:560px){.topbar{gap:6px}.search{min-width:unset;width:100%}.row{grid-template-columns:28px 1fr;grid-template-rows:auto auto}.col-commit{display:none}.actions{grid-column:1/-1;margin-top:8px}.btn{flex:1 1 auto;justify-content:center}}
  @media (max-width:380px){header h1{font-size:clamp(16px,5vw,20px)}.chip{padding:10px 12px;font-size:13px}.btn{padding:10px}.row{padding:12px}}
  footer{max-width:1100px;margin:10px auto calc(env(safe-area-inset-bottom)+24px);color:var(--muted);text-align:center;font-size:13px}`;
  document.head.appendChild(h("style", {}, css));

  // === HTML ===
  const root = h("div", { id: "files-app" }, [
    h("header", {}, [
      h("button", { class: "menu-btn", id: "menuBtn", ariaLabel: "–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é", ariaControls: "drawer", ariaExpanded: "false" }, "‚ò∞"),
      h("h1", {}, [ h("img", { src: CFG.brand.logo, alt: "–õ–æ–≥–æ—Ç–∏–ø", class: "logo" }), ` ${CFG.brand.title}` ])
    ]),
    h("aside", { class: "drawer", id: "drawer", ariaHidden: "true", tabIndex: "-1" }, [
      h("header", {}, [ h("img", { src: CFG.brand.logo, class: "logo", style: { height: "28px", borderRadius: "6px" } }), h("div", { class: "drawer-title" }, "–ù–∞–≤–∏–≥–∞—Ü–∏—è") ]),
      h("nav", {}, [
        h("a", { href: CFG.pages.index }, [h("span", { class: "icon" }, "üè†"), "–ì–ª–∞–≤–Ω–∞—è"]),
        h("a", { href: CFG.pages.teachers }, [h("span", { class: "icon" }, "üë©‚Äçüè´"), "–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏"]),
        h("a", { href: CFG.pages.files, "aria-current": "page" }, [h("span", { class: "icon" }, "üìÅ"), "–§–∞–π–ª—ã"])
      ])
    ]),
    h("div", { class: "backdrop", id: "backdrop", hidden: "" }),
    h("nav", { class: "toc", ariaLabel: "–ë—ã—Å—Ç—Ä—ã–µ –ø–∞–ø–∫–∏" }, h("div", { class: "toc-inner", id: "chips" })),
    h("main", { class: "container" }, [
      h("div", { class: "topbar" }, [
        h("h2", {}, "–ö–∞—Ç–∞–ª–æ–≥"),
        h("div", { class: "crumbs", id: "crumbs" }, "/"),
        h("div", { class: "search" }, h("input", { id: "search", type: "search", placeholder: "–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ‚Ä¶" })),
        h("a", { id: "toggleDates", class: "btn", href: "#" }, "‚è± –ü–æ–∫–∞–∑–∞—Ç—å –¥–∞—Ç—ã")
      ]),
      h("div", { class: "files", id: "grid" }, [
        h("div", { class: "row head" }, [h("div"), h("div", {}, "–ò–º—è"), h("div", { class: "col-size" }, "–†–∞–∑–º–µ—Ä"), h("div", { class: "col-commit" }, "–ò–∑–º–µ–Ω—ë–Ω"), h("div", {}, "–î–µ–π—Å—Ç–≤–∏—è")]),
        h("div", { class: "rows", id: "rows" })
      ])
    ]),
    h("footer", {}, CFG.brand.footer)
  ]);
  document.body.appendChild(root);

  // === —Ñ—É–Ω–∫—Ü–∏–∏ ===
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const fmtBytes = (n) => n == null ? "‚Äî" : (n < 1024 ? `${n} B` : n < 1024**2 ? `${(n/1024).toFixed(1)} KB` : n < 1024**3 ? `${(n/1024**2).toFixed(1)} MB` : `${(n/1024**3).toFixed(1)} GB`);
  const fmtDate = (iso) => iso ? new Date(iso).toLocaleString() : "‚Äî";
  const icon = (type, name) => type === 'dir' ? 'üìÇ' : /\.(pdf)$/i.test(name) ? 'üìÑ' : /\.(docx?|xlsx?|pptx?)$/i.test(name) ? 'üóé' : /\.(png|jpe?g|gif|webp|svg)$/i.test(name) ? 'üñºÔ∏è' : /\.(mp4|mov|webm|mkv)$/i.test(name) ? 'üéûÔ∏è' : /\.(mp3|wav|flac|m4a|ogg)$/i.test(name) ? 'üéµ' : 'üìÑ';
  const api = async (path, params={}) => {
    const url = new URL(`https://api.github.com${path}`);
    Object.entries(params).forEach(([k,v])=> url.searchParams.set(k,v));
    const headers = { 'Accept':'application/vnd.github+json' };
    const res = await fetch(url, { headers });
    if (!res.ok) { let msg = `${res.status} ${res.statusText}`; try { const t = await res.json(); if (t?.message) msg += `: ${t.message}` } catch {} throw new Error(msg); }
    return res.json();
  };
  const pathFromHash = () => decodeURIComponent(location.hash.replace(/^#\/?/, ''));
  const setHash = (p) => { location.hash = `/${encodeURIComponent(p)}`; };

  function renderCrumbs(path){
    const segs = path.split('/').filter(Boolean);
    $('#crumbs').textContent = segs.length? segs.map((s,i)=> i===0?`/${s}`:` / ${s}`).join('') : '/';
  }
  function renderChips(path, items){
    const dirs = items.filter(x=> x.type==='dir');
    const head = `<a class="chip" href="#" data-nav="${path}">üìÅ –ü–∞–ø–∫–∏:</a>`;
    const chips = dirs.map(d=> `<a class="chip" href="#" data-nav="${[path,d.name].filter(Boolean).join('/')}" title="–û—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É">${d.name}</a>`).join('');
    $('#chips').innerHTML = dirs.length ? head + ' ' + chips : '';
    $$('#chips a[data-nav]').forEach(a=> a.addEventListener('click', (e)=>{ e.preventDefault(); setHash(a.dataset.nav); }));
  }

  async function list(path=""){
    const repoPath = [CFG.rootPath, path].filter(Boolean).join('/');
    let items;
    try{
      items = await api(`/repos/${CFG.owner}/${CFG.repo}/contents/${encodeURIComponent(repoPath)}`, { ref: CFG.branch });
    }catch(e){
      $('#rows').innerHTML = `<div class='row item'><div>‚ö†Ô∏è</div><div class='empty'>${e.message}</div><div class='col-size'>‚Äî</div><div class='col-commit'>‚Äî</div><div></div></div>`;
      return;
    }
    renderCrumbs(path);
    items.sort((a,b)=> (a.type===b.type ? a.name.localeCompare(b.name) : a.type==='dir' ? -1 : 1));
    renderChips(path, items);

    let commitMap = {};
    if (CFG.showCommitDates) {
      await Promise.all(items.map(async it=>{
        const fullPath = [repoPath, it.name].filter(Boolean).join('/');
        try{ const [c] = await api(`/repos/${CFG.owner}/${CFG.repo}/commits`, { path: fullPath, sha: CFG.branch, per_page: 1 }); commitMap[it.name] = c ? c.commit.author.date : null; }
        catch{ commitMap[it.name] = null; }
      }));
    }

    const rows = items.map(it=>{
      const isDir = it.type === 'dir';
      const last = CFG.showCommitDates ? fmtDate(commitMap[it.name]) : '‚Äî';
      const openAttr = isDir ? `href="#" data-open="${[path, it.name].filter(Boolean).join('/')}"` : `href="${it.download_url}" target="_blank" rel="noopener"`;
      return `
        <div class="row item" data-name="${it.name.toLowerCase()}">
          <div>${icon(it.type, it.name)}</div>
          <div class="name"><a ${openAttr}>${it.name}</a> ${isDir?'<span class="tag">–ø–∞–ø–∫–∞</span>':'<span class="tag">—Ñ–∞–π–ª</span>'}</div>
          <div class="col-size">${isDir ? '‚Äî' : fmtBytes(it.size)}</div>
          <div class="col-commit">${last}</div>
          <div class="actions">
            ${isDir ? `<a class="btn" href="#" data-open="${[path, it.name].filter(Boolean).join('/')}">–û—Ç–∫—Ä—ã—Ç—å</a>`
                     : `<a class="btn" href="${it.download_url}" target="_blank" rel="noopener">–°–∫–∞—á–∞—Ç—å</a>`}
            <a class="btn" href="${it.html_url}" target="_blank" rel="noopener">–ù–∞ GitHub</a>
          </div>
        </div>`;
    }).join('');

    $('#rows').innerHTML = rows || `<div class="row item"><div>ü§∑‚Äç‚ôÄÔ∏è</div><div class="name">–ü—É—Å—Ç–æ</div><div class="col-size">‚Äî</div><div class="col-commit">‚Äî</div><div></div></div>`;
    $$('#rows [data-open]').forEach(a=> a.addEventListener('click', (e)=>{ e.preventDefault(); setHash(a.dataset.open); }));
  }

  // –ø–æ–∏—Å–∫
  document.addEventListener('input', (e)=>{
    if(e.target && e.target.id === 'search'){
      const q = e.target.value.trim().toLowerCase();
      $$('#rows .row.item').forEach(r=>{
        const name = (r.getAttribute('data-name')||'').toLowerCase();
        r.style.display = name.includes(q) ? '' : 'none';
      });
    }
  });
  // –¥–∞—Ç—ã
  document.addEventListener('click', async (e)=>{
    if(e.target && e.target.id === 'toggleDates'){
      e.preventDefault();
      CFG.showCommitDates = !CFG.showCommitDates;
      e.target.textContent = CFG.showCommitDates ? '‚è± –°–∫—Ä—ã—Ç—å –¥–∞—Ç—ã' : '‚è± –ü–æ–∫–∞–∑–∞—Ç—å –¥–∞—Ç—ã';
      await list(pathFromHash());
    }
  });

  // —Ä–æ—É—Ç–∏–Ω–≥
  window.addEventListener('hashchange', ()=> list(pathFromHash()));

  // drawer
  (function(){
    const btn = document.getElementById('menuBtn');
    const drawer = document.getElementById('drawer');
    const backdrop = document.getElementById('backdrop');
    const open = () => { drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false'); btn.setAttribute('aria-expanded','true'); backdrop.hidden = false; backdrop.classList.add('show'); };
    const close = () => { drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); btn.setAttribute('aria-expanded','false'); backdrop.classList.remove('show'); setTimeout(()=>{ backdrop.hidden = true; }, 200); };
    btn?.addEventListener('click', (e)=>{ e.preventDefault(); drawer.classList.contains('open')? close(): open(); });
    backdrop?.addEventListener('click', close);
    window.addEventListener('keydown', e=>{ if(e.key==='Escape' && drawer.classList.contains('open')) close(); });
    drawer?.querySelectorAll('a').forEach(a=> a.addEventListener('click', close));
  })();

  // —Å—Ç–∞—Ä—Ç
  list(pathFromHash());
})();
</script>

  <!-- —Å—é–¥–∞ –≤—Å—Ç–∞–≤–ª—è–µ—à—å –º–æ–π –±–æ–ª—å—à–æ–π <script> –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è -->
</body>
</html>
